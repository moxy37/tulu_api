<!DOCTYPE html>

<html lang="en">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>WebcamJS Test Page</title>
	<style type="text/css">
		body {
			font-family: Helvetica, sans-serif;
		}

		h2,
		h3 {
			margin-top: 0;
		}

		form {
			margin-top: 15px;
		}

		form>input {
			margin-right: 15px;
		}

		#results {
			float: left;
			margin: 40px;
			padding: 20px;
			border: 1px solid;
			background: #ccc;
		}
	</style>
</head>

<body>
	<h1>Camera Test</h1>


	<form id="upload-photos" method="post" action="/api/file/upload" enctype="multipart/form-data">
		<div class="form-group">
			<label for="photos-input">Load Image</label>
			<input id="photos-input" type="file" name="photos[]" multiple="multiple" accept="image/*" capture />
		</div>
		<input type="hidden" name="csrf_token" value="just_a_text_field" />
		<input class="btn btn-default" type="submit" name="Photo Uploads" value="Upload" />
	</form>

	<div id="results">
		<p><img src="" id="img" alt="from phone" /></p>
	</div>

	<!-- <div id="my_camera" onclick="take_snapshot();"></div> -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script>
		$('#upload-photos').on('submit', function (event) {
			event.preventDefault();
			var files = $('#photos-input').get(0).files;
			var formData = new FormData();
			if (files.length === 0) { return false; }
			for (var i = 0; i < files.length; i++) {
				var file = files[i];
				formData.append('photos[]', file, file.name);
			}
			uploadFiles(formData);
		});

		function uploadFiles(formData) {
			$.ajax({
				url: '/api/file/upload',
				method: 'post',
				data: formData,
				processData: false,
				contentType: false,
				xhr: function () {
					var xhr = new XMLHttpRequest();

					return xhr;
				}
			}).done(handleSuccess).fail(function (xhr, status) {
				alert(status);
			});
			$("#upload-photos").hide();
		}

	</script>


</body>

</html>